⟨Box⟩⇐⋄D←{p←' '∾˜("│↓"⊑˜0=⊑𝕩)⥊˜1-˜=𝕨⋄p↩("│ ")⍟(1≥=𝕨)p⋄p∾(1⊑𝕩)∾"│"}⋄C←{∾´⟨(⊑𝕨)⥊˜b←+´∧`' '≠a←⊑˘⍉𝕩,1⊑𝕨,'─'⥊˜2-˜≠b↓a,2⊑𝕨⟩}⋄F←{0=≠≢𝕩?n←@+10⋄"┌⊖┐"∾n∾"│"∾(<⍟(2=•Type 𝕩)•Fmt⍟(2≠•Type)𝕩)∾"│"∾n∾"└─┘";¯1↓⥊(∾⟜n)˘(⌽⟨'└'," ~"""⊑˜•Type⊑𝕩,'┘'⟩⊸C○{1↓𝕩}∾⌽∘⊢)("┌→┐"⊸C∾⊢)(𝕩⊸D)˘(⍉↕∘≠≍<˘)>{𝕩∾¨' '⥊˜¨(⌈´-⊢)≠¨𝕩}1⊸↓⌾⌽¨(∾⟜' ')⌾(⊑∘⌽){𝕩⊔˜»+`n=𝕩}∾´⥊({∾⟜' '⍟(0⌈(1+⌈´≠¨⥊a)-≠𝕩)⊢𝕩}¨a←{•Fmt⍟(2≠•Type)𝕩}¨𝕩)∾¨(n←@+10)⥊¨˜0⌾(⊑○⌽○⥊)(≢𝕩)⥊(≠⥊𝕩){+´(𝕨⥊·⌽↑⟜1)¨𝕩}×`⌾⌽1↓≢𝕩}⋄Box←{1≥≡𝕩?F𝕩;n←@+10⋄¯1↓⥊(∾⟜n)˘(⌽⟨'└','∊','┘'⟩⊸C○{1↓𝕩}∾⌽∘⊢)("┌→┐"⊸C∾⊢)(𝕩⊸D)˘(⍉↕∘≠≍<˘)>{(∾𝕊¨)⍟(2<≡)⥊𝕩}{v‿r←𝕩⋄{𝕩∾<' '⥊˜≠⊏>⥊a}⍟r⊢v}¨<˘⍉(⋈¨⥊a)≍«»(≠⥊a){+´(𝕨⥊·⌽↑⟜1)¨𝕩}×`⌽≢a←<⎉1⊢b{∾˝⎉2⍉>⌾⍉(>𝕨)∾¨' '↑˜¨𝕩-˜1+⌈˝𝕩}{≠⊑}¨b←{(n=𝕩)(⊢-˜+`×¬)⊸⊔𝕩}¨𝕊¨𝕩}
